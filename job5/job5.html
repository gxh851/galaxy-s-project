<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <title>XXç”µå•†Â·è¿è¥åå°Â·è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</title>
    <style>
        body { font-family: Arial, sans-serif;}
        .box { border:1px solid #ddd; padding:10px; margin:10px 0;}
        .clock { font-size: 20px; font-weight:bold; color: #336699;}
        label { display:inline-block; width:120px;}
        table { border-collapse: collapse; width:100% ; margin-top:10px; }
        th, td { border:1px solid #ccc; padding:4px 8px; text-align:center; }
        .tips { padding:12px; margin:10px 0; border-left:5px solid; font-size:14px; }
    </style>
</head>
<body>
    <div id="clock" class="clock"></div>

    <script>

        document.write("<h1>XXç”µå•†Â·è¿è¥åå°Â·è®¢å•å½•å…¥ä¸é”€å”®çœ‹æ¿</h1>");
        document.write("<p>æ¬¢è¿ä½¿ç”¨å†…éƒ¨å·¥å…·, å®æ—¶æŸ¥çœ‹è®¢å•ä¸é”€å”®æƒ…å†µã€‚</p>");

        document.write(
            '<div class="tips" style="background:#eef9ff; border-color:#3aa0e6;">' +
            '<strong>ğŸ’¡æ¸©é¦¨æç¤º: æœ¬åº—å½“å‰å¯äº«å—çš„ä¼˜æƒ ä¸åŠ ä»·æ”¿ç­–å¦‚ä¸‹:</strong>' +
            '<ul style="margin:8px 0 0 20px; line-height:1.6;">' +
            '<li>ğŸ‰VIP å®¢æˆ·äº«å—<strong>9 æŠ˜ä¼˜æƒ </strong></li>' +
            '<li>âš¡åŠ æ€¥å‘è´§ä»·æ ¼ä¼š<strong>Ã—1.1</strong></li>' +
            '<li>â°æ¯å°æ—¶å‰10åˆ†é’Ÿå†äº« <strong>8.5 æŠ˜</strong></li>' +
            '<li>â°æ™®é€šå®¢æˆ·è´­ä¹°æ•°é‡&gt;3ä»¶ï¼Œé¢å¤–äº«å—9æŠ˜ä¼˜æƒ </li>' +
            '</ul>' +
            '</div>'
        );

     
        function padZero(n){
            return n <10?"0"+n: n;
        }
       
        function updateClock(){
            var now = new Date();
            var y = now.getFullYear();
            var m= now.getMonth()+1;
            var d = now.getDate();
            var hh = now.getHours();
            var mm=now.getMinutes();
            var ss = now.getSeconds();
            var weekNames =["æ—¥","ä¸€","äºŒ","ä¸‰","å››","äº”","å…­"];
            var w = weekNames[now.getDay()];
            var timeStr = y+"å¹´"+padZero(m)+"æœˆ"+padZero(d)+"æ—¥æ˜ŸæœŸ"+w+" "+padZero(hh)+":"+padZero(mm)+":"+padZero(ss);
            document.getElementById("clock").innerHTML = timeStr;
        }
        // é¡µé¢åˆšåŠ è½½æ—¶è°ƒç”¨ä¸€æ¬¡
        updateClock();
        setInterval(updateClock, 1000); 

        // æ—¶æ®µæŠ˜æ‰£æé†’
        var nowForBanner = new Date();
        var minuteForBanner=nowForBanner.getMinutes(); //getMinutes():è·å–å½“å‰åˆ†é’Ÿ(0-59)
        if (minuteForBanner >=0 && minuteForBanner <=9){
            document.write(
                '<div style="padding:12px; background:#fffbe6; border-left:5px solid #f4d06f; margin:10px 0; font-size:14px;">' +
                'å½“å‰ä¸ºå‰ 10 åˆ†é’Ÿ! æœ¬å•å¯é¢å¤–äº«å—<strong>8.5 æŠ˜</strong>æ—¶æ®µä¼˜æƒ !' +
                '</div>'
            );
        } else {
            document.write(
                '<div style="padding:12px; background:#f5f5f5; border-left:5px solid #ccc; margin:10px 0; font-size:14px;">' +
                'å°è´´å£«:æ¯ä¸ªæ•´ç‚¹å‰10 åˆ†é’Ÿäº«å— 8.5 æŠ˜ä¼˜æƒ ,è¯·ç•™æ„ä¸‹å•æ—¶é—´~' +
                '</div>'
            );
        }
    </script>

    <!-- è®¢å•å½•å…¥è¡¨å• -->
    <div class="box">
        <h3>æ–°å»ºè®¢å•</h3>
        <form onsubmit="return validateForm()">
            <p>
                <label>å®¢æˆ·åç§°ï¼š</label>
                <input type="text" id="customerName" placeholder="è¯·è¾“å…¥å®¢æˆ·åç§°">
            </p>
            <p>
                <label>å•†å“å•ä»·(Â¥)ï¼š</label>
                <input type="text" id="priceInput" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•°å­—">
            </p>
            <p>
                <label>æ•°é‡(ä»¶)ï¼š</label>
                <input type="text" id="qtyInput" placeholder="è¯·è¾“å…¥å¤§äº0çš„æ•´æ•°">
            </p>
            <p>
                <label>å®¢æˆ·ç±»å‹ï¼š</label>
                <select id="customerType">
                    <option value="normal">æ™®é€šå®¢æˆ·</option>
                    <option value="vip">VIPå®¢æˆ·</option>
                </select>
            </p>
            <p>
                <label>åŠ æ€¥å‘è´§ï¼š</label>
                <input type="checkbox" id="urgentFlag"> æ˜¯
            </p>
            <p>
                <button type="submit">æ·»åŠ è®¢å•</button>
            </p>
        </form>
    </div>

    <!-- è®¢å•ç»“æœå±•ç¤º -->
    <div class="box" id="orderResult"></div>

    <!-- é”€å”®çœ‹æ¿ä¸å†å²è®¢å• -->
    <div class="box">
        <h3>é”€å”®çœ‹æ¿</h3>
        <div id="dashboard"></div>
        <h3>å†å²è®¢å•</h3>
        <div id="orderTable"></div>
    </div>

    <script>
    
        var orders = [];

       
        function validateForm(){
     
            var nameStr = document.getElementById("customerName").value;
            var priceStr = document.getElementById("priceInput").value;
            var qtyStr = document.getElementById("qtyInput").value;
            var typeStr = document.getElementById("customerType").value;
            var urgentChecked = document.getElementById("urgentFlag").checked;
            var valid = true;
            // å®¢æˆ·åç§°æ ¡éªŒ
            if (nameStr == null || nameStr.trim()===""){
                alert("å®¢æˆ·åç§°ä¸èƒ½ä¸ºç©º!");
                valid = false;
            }
            // parseFloat():æŠŠå­—ç¬¦ä¸²è½¬æˆæµ®ç‚¹å‹æ•°å­—
            var price = parseFloat(priceStr);
            if (isNaN(price) || price <=0){
                alert("å•†å“å•ä»·å¿…é¡»æ˜¯å¤§äº0çš„æ•°å­—!");
                valid = false;
            }
            // parseInt():æŠŠå­—ç¬¦ä¸²è½¬æˆæ•´æ•°
            var qty = parseInt(qtyStr, 10);
            if (isNaN(qty) || qty <=0){
                alert("æ•°é‡å¿…é¡»æ˜¯å¤§äº0çš„æ•´æ•°!");
                valid = false;
            }
            if (!valid){
                document.getElementById("orderResult").innerHTML=
                "<p>è®¢å•å½•å…¥å¤±è´¥, è¯·æ£€æŸ¥è¾“å…¥ã€‚</p>";
                return false;
            }
            processOrder(nameStr.trim(), price, qty, typeStr === "vip", urgentChecked);
            return false;
        }


        function processOrder(customerName, price, quantity, isVip, isUrgent) {
            var baseTotal = price * quantity;
            var afterVip = isVip ? baseTotal * 0.9 : baseTotal;
            var afterUrgent = isUrgent ? afterVip * 1.1 : afterVip;
            var now = new Date();
            var minute = now.getMinutes();
            var hitTimeDiscount = false;
            var finalTotal = afterUrgent;
            
            if (minute >=0 && minute<=9){
                finalTotal *=0.85;
                hitTimeDiscount= true;
            }

  
            var extraDiscount = false;
            if (!isUrgent && quantity >= 2) {
                finalTotal *= 0.98;
                extraDiscount = true;
            }

            var normalQtyDiscount = false;
            if (!isVip && quantity > 3) {
                finalTotal *= 0.9;
                normalQtyDiscount = true;
            }

            var isImportant = isVip && finalTotal > 1000;
            var tipsHtml = "<ul>";
            tipsHtml += isVip ? "<li>ğŸ‰VIP 9æŠ˜å·²åº”ç”¨</li>" : "<li>æ™®é€šå®¢æˆ·æ— VIPä¼˜æƒ </li>";
            tipsHtml += isUrgent ? "<li>âš¡åŠ æ€¥ Ã—1.1 å·²åº”ç”¨</li>" : "<li>æœªåŠ æ€¥</li>";
            tipsHtml += hitTimeDiscount ? "<li>â°å‘½ä¸­å‰10åˆ†é’Ÿ Ã—0.85</li>" : "<li>æ— æ—¶æ®µæŠ˜æ‰£</li>";
            tipsHtml += extraDiscount ? "<li>ğŸ“¦æœªåŠ æ€¥+æ•°é‡â‰¥2ä»¶ é¢å¤–98æŠ˜</li>" : "<li>æ— é¢å¤–æŠ˜æ‰£</li>";
            tipsHtml += normalQtyDiscount ? "<li>ğŸ“¦æ™®é€šå®¢æˆ·+æ•°é‡>3ä»¶ é¢å¤–9æŠ˜</li>" : "";
            tipsHtml += "</ul>";
            
            document.getElementById("orderResult").innerHTML=
            "<h3>è®¢å•å½•å…¥æˆåŠŸ:</h3>"+
            "<p>å®¢æˆ·åç§°:"+ customerName + "</p>"+
            "<p>åŸºç¡€é‡‘é¢: Â¥"+ baseTotal.toFixed(2) +"</p>"+
            "<p>VIP å:Â¥"+ afterVip.toFixed(2) +"</p>"+
            "<p>åŠ æ€¥å:Â¥"+ afterUrgent.toFixed(2)+"</p>"+
            "<p>æœ€ç»ˆé‡‘é¢: Â¥"+ finalTotal.toFixed(2)+"</p>"+
            "<p>è®¢å•ç±»å‹:"+(isImportant?"å¤§é¢ VIP":"æ™®é€šè®¢å•")+"</p>"+
            "<div style='background:#eef; padding:8px; '>ä¼˜æƒ è¯¦æƒ…:"+ tipsHtml + "</div>";
            
            orders.push({
                name: customerName,
                price: price,
                qty: quantity,
                baseTotal: baseTotal,
                finalTotal: finalTotal,
                isVip: isVip,
                isUrgent: isUrgent,
                hitTimeDiscount: hitTimeDiscount
            });

            // æ–°å¢è®¢å•åæ›´æ–°çœ‹æ¿
            renderDashboard();
        }

        // ç¬¬äº”æ–¹é¢ï¼šé”€å”®çœ‹æ¿ä¸å†å²è®¢å•
        function renderDashboard(){
            var count = orders.length;
            var totalSales =0;
            
            for (var i=0; i<orders.length; i++) {
                totalSales += orders[i].finalTotal;
            }
            var avg = count >0 ? totalSales / count : 0;
          
            document.getElementById("dashboard").innerHTML=
            "<p>è®¢å•æ•°:"+ count +"</p>"+
            "<p>é”€å”®æ€»é¢: Â¥"+ totalSales.toFixed(2)+"</p>"+
            "<p>å¹³å‡å®¢å•ä»·: Â¥"+ avg.toFixed(2) +"</p>";
            
            var tableHtml = "<table><tr>"+
            "<<th>å®¢æˆ·åç§°</</th><<th>å•ä»·</</th><<th>æ•°é‡</</th><<th>åŸºç¡€é‡‘é¢</</th><<th>æœ€ç»ˆé‡‘é¢</</th><<th>VIP</</th><<th>åŠ æ€¥</</th><<th>æ—¶æ®µæŠ˜æ‰£</</th>"+
            "</tr>";
            
            for (var j=0; j<orders.length;j++){
                var o= orders[j];
                tableHtml += "<tr>"+
                "<td>" + o.name +"</td>"+
                "<td>Â¥" + o.price.toFixed(2)+"</td>"+
                "<td>" + o.qty +"</td>"+
                "<td>Â¥" + o.baseTotal.toFixed(2) +"</td>"+
                "<td>Â¥" + o.finalTotal.toFixed(2) +"</td>"+
                "<td>"+(o.isVip ?"æ˜¯":"å¦")+"</td>"+
                "<td>"+ (o.isUrgent?"æ˜¯":"å¦")+"</td>"+
                "<td>"+(o.hitTimeDiscount?"æ˜¯":"å¦")+"</td>"+
                "</tr>";
            }
            tableHtml +="</table>";
            document.getElementById("orderTable").innerHTML = tableHtml;
        }

        // åˆå§‹åŒ–é”€å”®çœ‹æ¿
        renderDashboard();
    </script>
</body>
</html>